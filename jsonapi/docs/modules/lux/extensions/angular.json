{"modified": "2014-11-11T17:40:26", "content_type": "text/html", "site": {"lux_version": "0.1.1-alpha.1", "template_engine": null, "year": 2014, "url": "http://quantmind.github.io/lux", "python_version": "3.4.2", "media": "/media", "date": "2014-11-11T17-40-20", "name": "Lux", "template": "doc.html"}, "html_url": "http://quantmind.github.io/lux/docs/modules/lux/extensions/angular", "head": {}, "name": "modules_lux_extensions_angular", "slug": "modules/lux/extensions/angular", "api_url": "http://quantmind.github.io/lux/jsonapi/docs/modules/lux/extensions/angular", "html": {"main": "<section id=\"page-header\" class=\"page-header-outer modules_lux_extensions_angular-header\">\n    <div class=\"layer\">\n        <div class=\"page-header\">\n            <div class=\"container fullpage\">\n                <div class=\"row fullpage\">\n                    <div class=\"col-sm-12 text-center\">\n                        <breadcrumbs></breadcrumbs>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n</section>\n\n<div id=\"page-main\">\n    <div class=\"container\">\n        <div class=\"row\">\n            <div class=\"modules_lux_extensions_angular-main col-md-12\">\n                <div class=\"center-block\" style=\"max-width: 900px\" data-highlight data-hash-scroll>\n                    <h1>Source code for lux.extensions.angular</h1><div class=\"highlight\"><pre>\n<span class=\"sd\">&#39;&#39;&#39;\\</span>\n<span class=\"sd\">THis extension does not provide any middleware but it is required</span>\n<span class=\"sd\">when using :ref:`lux.js &lt;jsapi&gt;` javascript module and</span>\n<span class=\"sd\">provides the link between AngularJS_ and Python.</span>\n\n<span class=\"sd\">**Required extensions**: :mod:`lux.extensions.ui`</span>\n\n<span class=\"sd\">Usage</span>\n<span class=\"sd\">=========</span>\n\n<span class=\"sd\">Include ``lux.extensions.angular`` into the :setting:`EXTENSIONS` list in your</span>\n<span class=\"sd\">:ref:`config file &lt;parameters&gt;`::</span>\n\n<span class=\"sd\">    EXTENSIONS = [</span>\n<span class=\"sd\">        ...</span>\n<span class=\"sd\">        &#39;lux.extensions.ui&#39;,</span>\n<span class=\"sd\">        &#39;lux.extensions.angular&#39;</span>\n<span class=\"sd\">        ...</span>\n<span class=\"sd\">        ]</span>\n\n<span class=\"sd\">     ANGULAR_UI_ROUTER = True</span>\n\n<span class=\"sd\">There are two different ways to serve html. The default way is to serve without</span>\n<span class=\"sd\">the use of angular `ui-router`_, in which case urls load the whole html5</span>\n<span class=\"sd\">document each time they are accessed.</span>\n\n<span class=\"sd\">.. _spa-router:</span>\n\n<span class=\"sd\">UI-Router</span>\n<span class=\"sd\">=============</span>\n\n<span class=\"sd\">When switching :setting:`ANGULAR_UI_ROUTER` to ``True``, each page served by</span>\n<span class=\"sd\">an angular :class:`.Router` is managed, in javascript, by the `ui-router`_ as</span>\n<span class=\"sd\">a single page application.</span>\n\n\n<span class=\"sd\">.. _AngularJS: https://angularjs.org/</span>\n<span class=\"sd\">.. _`ui-router`: https://github.com/angular-ui/ui-router</span>\n<span class=\"sd\">&#39;&#39;&#39;</span>\n<span class=\"kn\">import</span> <span class=\"nn\">lux</span>\n<span class=\"kn\">from</span> <span class=\"nn\">lux</span> <span class=\"kn\">import</span> <span class=\"n\">Parameter</span><span class=\"p\">,</span> <span class=\"n\">RouterParam</span>\n\n<span class=\"kn\">from</span> <span class=\"nn\">pulsar.apps.wsgi</span> <span class=\"kn\">import</span> <span class=\"n\">MediaMixin</span><span class=\"p\">,</span> <span class=\"n\">Html</span><span class=\"p\">,</span> <span class=\"n\">route</span>\n<span class=\"kn\">from</span> <span class=\"nn\">pulsar.utils.httpurl</span> <span class=\"kn\">import</span> <span class=\"n\">urlparse</span>\n\n<span class=\"kn\">from</span> <span class=\"nn\">.ui</span> <span class=\"kn\">import</span> <span class=\"n\">add_css</span>\n\n\n<span class=\"k\">class</span> <span class=\"nc\">Extension</span><span class=\"p\">(</span><span class=\"n\">lux</span><span class=\"o\">.</span><span class=\"n\">Extension</span><span class=\"p\">):</span>\n\n    <span class=\"n\">_config</span> <span class=\"o\">=</span> <span class=\"p\">[</span>\n        <span class=\"n\">Parameter</span><span class=\"p\">(</span><span class=\"s\">&#39;HTML5_NAVIGATION&#39;</span><span class=\"p\">,</span> <span class=\"bp\">True</span><span class=\"p\">,</span> <span class=\"s\">&#39;Enable Html5 navigation&#39;</span><span class=\"p\">),</span>\n        <span class=\"n\">Parameter</span><span class=\"p\">(</span><span class=\"s\">&#39;ANGULAR_UI_ROUTER&#39;</span><span class=\"p\">,</span> <span class=\"bp\">False</span><span class=\"p\">,</span> <span class=\"s\">&#39;Enable Angular ui-router&#39;</span><span class=\"p\">),</span>\n        <span class=\"n\">Parameter</span><span class=\"p\">(</span><span class=\"s\">&#39;ANGULAR_VIEW_ANIMATE&#39;</span><span class=\"p\">,</span> <span class=\"bp\">False</span><span class=\"p\">,</span>\n                  <span class=\"s\">&#39;Enable Animation of ui-router views.&#39;</span><span class=\"p\">),</span>\n        <span class=\"n\">Parameter</span><span class=\"p\">(</span><span class=\"s\">&#39;NAVBAR_COLLAPSE_WIDTH&#39;</span><span class=\"p\">,</span> <span class=\"mi\">768</span><span class=\"p\">,</span>\n                  <span class=\"s\">&#39;Width when to collapse the navbar&#39;</span><span class=\"p\">),</span>\n        <span class=\"n\">Parameter</span><span class=\"p\">(</span><span class=\"s\">&#39;NGMODULES&#39;</span><span class=\"p\">,</span> <span class=\"p\">[],</span> <span class=\"s\">&#39;Angular module to load&#39;</span><span class=\"p\">)</span>\n    <span class=\"p\">]</span>\n\n    <span class=\"k\">def</span> <span class=\"nf\">on_html_document</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span> <span class=\"n\">app</span><span class=\"p\">,</span> <span class=\"n\">request</span><span class=\"p\">,</span> <span class=\"n\">doc</span><span class=\"p\">):</span>\n        <span class=\"nb\">min</span> <span class=\"o\">=</span> <span class=\"s\">&#39;.min&#39;</span> <span class=\"k\">if</span> <span class=\"n\">app</span><span class=\"o\">.</span><span class=\"n\">config</span><span class=\"p\">[</span><span class=\"s\">&#39;MINIFIED_MEDIA&#39;</span><span class=\"p\">]</span> <span class=\"k\">else</span> <span class=\"s\">&#39;&#39;</span>\n        <span class=\"n\">js</span> <span class=\"o\">=</span> <span class=\"n\">app</span><span class=\"o\">.</span><span class=\"n\">template</span><span class=\"p\">(</span><span class=\"s\">&#39;lux.require</span><span class=\"si\">%s</span><span class=\"s\">.js&#39;</span> <span class=\"o\">%</span> <span class=\"nb\">min</span><span class=\"p\">)</span>\n        <span class=\"n\">doc</span><span class=\"o\">.</span><span class=\"n\">head</span><span class=\"o\">.</span><span class=\"n\">embedded_js</span><span class=\"o\">.</span><span class=\"n\">append</span><span class=\"p\">(</span><span class=\"n\">js</span><span class=\"p\">)</span>\n\n\n<div class=\"viewcode-block\" id=\"Router\"><a class=\"viewcode-back\" href=\"../../../api/angular#lux.extensions.angular.Router\">[docs]</a><span class=\"k\">class</span> <span class=\"nc\">Router</span><span class=\"p\">(</span><span class=\"n\">lux</span><span class=\"o\">.</span><span class=\"n\">Router</span><span class=\"p\">,</span> <span class=\"n\">MediaMixin</span><span class=\"p\">):</span>\n    <span class=\"sd\">&#39;&#39;&#39;A :class:`.Router` for Angular navigation.</span>\n<span class=\"sd\">    &#39;&#39;&#39;</span>\n    <span class=\"n\">in_nav</span> <span class=\"o\">=</span> <span class=\"bp\">True</span>\n    <span class=\"n\">title</span> <span class=\"o\">=</span> <span class=\"bp\">None</span>\n    <span class=\"n\">api</span> <span class=\"o\">=</span> <span class=\"bp\">None</span>\n    <span class=\"n\">angular_view_class</span> <span class=\"o\">=</span> <span class=\"n\">RouterParam</span><span class=\"p\">(</span><span class=\"s\">&#39;angular-view&#39;</span><span class=\"p\">)</span>\n    <span class=\"n\">html_body_template</span> <span class=\"o\">=</span> <span class=\"n\">RouterParam</span><span class=\"p\">(</span><span class=\"s\">&#39;home.html&#39;</span><span class=\"p\">)</span>\n    <span class=\"sd\">&#39;&#39;&#39;The template for the body part of the Html5 document. In most cases it</span>\n<span class=\"sd\">    is as simple as::</span>\n\n<span class=\"sd\">        $html_main</span>\n\n<span class=\"sd\">    where the ``$html_main`` is replaced by the string created by the</span>\n<span class=\"sd\">    :meth:`build_main` method.</span>\n<span class=\"sd\">    &#39;&#39;&#39;</span>\n    <span class=\"n\">ngmodules</span> <span class=\"o\">=</span> <span class=\"bp\">None</span>\n    <span class=\"sd\">&#39;&#39;&#39;Optional list of angular modules to include</span>\n<span class=\"sd\">    &#39;&#39;&#39;</span>\n    <span class=\"n\">uirouter</span> <span class=\"o\">=</span> <span class=\"bp\">True</span>\n    <span class=\"sd\">&#39;&#39;&#39;Override the :setting:`ANGULAR_UI_ROUTER` setting for this</span>\n<span class=\"sd\">    :class:`.Router`. If set to ``False`` the `ui-router`_ won&#39;t be used</span>\n<span class=\"sd\">    and the whole html5 document is loaded when accessed.&#39;&#39;&#39;</span>\n    <span class=\"n\">_sitemap</span> <span class=\"o\">=</span> <span class=\"bp\">None</span>\n\n<div class=\"viewcode-block\" id=\"Router.get\"><a class=\"viewcode-back\" href=\"../../../api/angular#lux.extensions.angular.Router.get\">[docs]</a>    <span class=\"k\">def</span> <span class=\"nf\">get</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span> <span class=\"n\">request</span><span class=\"p\">):</span>\n        <span class=\"sd\">&#39;&#39;&#39;This is the only http method implemented.</span>\n\n<span class=\"sd\">        If this :class:`.Router` is operating in :ref:`ui mode &lt;spa-router&gt;`,</span>\n<span class=\"sd\">        this method performs the following tasks:</span>\n\n<span class=\"sd\">        * Collets children routers operating in :ref:`ui mode &lt;spa-router&gt;`</span>\n<span class=\"sd\">          and build the sitemap used by angular `ui-router`_.</span>\n<span class=\"sd\">        * The ``$html_main`` content, rendered by the :meth:`build_main` method is</span>\n<span class=\"sd\">          wrapped by a ``div`` element::</span>\n\n<span class=\"sd\">            &lt;div id=&quot;seo-view&quot; data-ui-main=&quot;main&quot; class=&quot;hidden&quot;&gt;</span>\n<span class=\"sd\">                $html_main</span>\n<span class=\"sd\">            &lt;/div&gt;</span>\n<span class=\"sd\">        &#39;&#39;&#39;</span>\n        <span class=\"n\">app</span> <span class=\"o\">=</span> <span class=\"n\">request</span><span class=\"o\">.</span><span class=\"n\">app</span>\n        <span class=\"n\">uirouter</span> <span class=\"o\">=</span> <span class=\"n\">app</span><span class=\"o\">.</span><span class=\"n\">config</span><span class=\"p\">[</span><span class=\"s\">&#39;ANGULAR_UI_ROUTER&#39;</span><span class=\"p\">]</span> <span class=\"ow\">and</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">uirouter</span>\n        <span class=\"n\">doc</span> <span class=\"o\">=</span> <span class=\"n\">request</span><span class=\"o\">.</span><span class=\"n\">html_document</span>\n        <span class=\"n\">doc</span><span class=\"o\">.</span><span class=\"n\">body</span><span class=\"o\">.</span><span class=\"n\">data</span><span class=\"p\">({</span><span class=\"s\">&#39;ng-model&#39;</span><span class=\"p\">:</span> <span class=\"s\">&#39;page&#39;</span><span class=\"p\">,</span>\n                       <span class=\"s\">&#39;ng-controller&#39;</span><span class=\"p\">:</span> <span class=\"s\">&#39;Page&#39;</span><span class=\"p\">,</span>\n                       <span class=\"s\">&#39;page&#39;</span><span class=\"p\">:</span> <span class=\"s\">&#39;&#39;</span><span class=\"p\">})</span>\n        <span class=\"c\">#</span>\n        <span class=\"c\"># Add info to jscontext</span>\n        <span class=\"n\">jscontext</span> <span class=\"o\">=</span> <span class=\"n\">doc</span><span class=\"o\">.</span><span class=\"n\">jscontext</span>\n        <span class=\"n\">jscontext</span><span class=\"p\">[</span><span class=\"s\">&#39;html5mode&#39;</span><span class=\"p\">]</span> <span class=\"o\">=</span> <span class=\"n\">app</span><span class=\"o\">.</span><span class=\"n\">config</span><span class=\"p\">[</span><span class=\"s\">&#39;HTML5_NAVIGATION&#39;</span><span class=\"p\">]</span>\n        <span class=\"n\">navbar</span> <span class=\"o\">=</span> <span class=\"n\">doc</span><span class=\"o\">.</span><span class=\"n\">jscontext</span><span class=\"o\">.</span><span class=\"n\">get</span><span class=\"p\">(</span><span class=\"s\">&#39;navbar&#39;</span><span class=\"p\">)</span> <span class=\"ow\">or</span> <span class=\"p\">{}</span>\n        <span class=\"n\">navbar</span><span class=\"p\">[</span><span class=\"s\">&#39;collapseWidth&#39;</span><span class=\"p\">]</span> <span class=\"o\">=</span> <span class=\"n\">app</span><span class=\"o\">.</span><span class=\"n\">config</span><span class=\"p\">[</span><span class=\"s\">&#39;NAVBAR_COLLAPSE_WIDTH&#39;</span><span class=\"p\">]</span>\n        <span class=\"n\">jscontext</span><span class=\"p\">[</span><span class=\"s\">&#39;navbar&#39;</span><span class=\"p\">]</span> <span class=\"o\">=</span> <span class=\"n\">navbar</span>\n        <span class=\"c\">#</span>\n        <span class=\"c\"># Build the ui-view main</span>\n        <span class=\"n\">main</span> <span class=\"o\">=</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">build_main</span><span class=\"p\">(</span><span class=\"n\">request</span><span class=\"p\">)</span>\n        <span class=\"c\">#</span>\n        <span class=\"n\">ngmodules</span> <span class=\"o\">=</span> <span class=\"n\">jscontext</span><span class=\"p\">[</span><span class=\"s\">&#39;ngModules&#39;</span><span class=\"p\">]</span> <span class=\"o\">=</span> <span class=\"nb\">set</span><span class=\"p\">(</span><span class=\"n\">jscontext</span><span class=\"o\">.</span><span class=\"n\">get</span><span class=\"p\">(</span><span class=\"s\">&#39;ngModules&#39;</span><span class=\"p\">,</span> <span class=\"p\">()))</span>\n        <span class=\"n\">ngmodules</span><span class=\"o\">.</span><span class=\"n\">update</span><span class=\"p\">(</span><span class=\"n\">app</span><span class=\"o\">.</span><span class=\"n\">config</span><span class=\"p\">[</span><span class=\"s\">&#39;NGMODULES&#39;</span><span class=\"p\">])</span>\n        <span class=\"c\">#</span>\n        <span class=\"c\"># Using Angular Ui-Router</span>\n        <span class=\"k\">if</span> <span class=\"n\">uirouter</span><span class=\"p\">:</span>\n            <span class=\"n\">jscontext</span><span class=\"o\">.</span><span class=\"n\">update</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">sitemap</span><span class=\"p\">(</span><span class=\"n\">app</span><span class=\"p\">,</span> <span class=\"n\">ngmodules</span><span class=\"p\">))</span>\n            <span class=\"n\">jscontext</span><span class=\"p\">[</span><span class=\"s\">&#39;page&#39;</span><span class=\"p\">]</span> <span class=\"o\">=</span> <span class=\"n\">router_href</span><span class=\"p\">(</span><span class=\"n\">app</span><span class=\"p\">,</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">full_route</span><span class=\"p\">)</span>\n        <span class=\"k\">elif</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">ngmodules</span><span class=\"p\">:</span>\n            <span class=\"n\">ngmodules</span><span class=\"o\">.</span><span class=\"n\">update</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">ngmodules</span><span class=\"p\">)</span>\n\n        <span class=\"k\">if</span> <span class=\"n\">uirouter</span><span class=\"p\">:</span>\n            <span class=\"n\">main</span> <span class=\"o\">=</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">uiview</span><span class=\"p\">(</span><span class=\"n\">app</span><span class=\"p\">,</span> <span class=\"n\">main</span><span class=\"p\">,</span> <span class=\"n\">jscontext</span><span class=\"p\">)</span>\n        <span class=\"k\">elif</span> <span class=\"nb\">isinstance</span><span class=\"p\">(</span><span class=\"n\">main</span><span class=\"p\">,</span> <span class=\"n\">Html</span><span class=\"p\">):</span>\n            <span class=\"n\">main</span> <span class=\"o\">=</span> <span class=\"n\">main</span><span class=\"o\">.</span><span class=\"n\">render</span><span class=\"p\">()</span>\n\n        <span class=\"n\">jscontext</span><span class=\"p\">[</span><span class=\"s\">&#39;ngModules&#39;</span><span class=\"p\">]</span> <span class=\"o\">=</span> <span class=\"nb\">list</span><span class=\"p\">(</span><span class=\"n\">jscontext</span><span class=\"p\">[</span><span class=\"s\">&#39;ngModules&#39;</span><span class=\"p\">])</span>\n        <span class=\"n\">context</span> <span class=\"o\">=</span> <span class=\"p\">{</span><span class=\"s\">&#39;html_main&#39;</span><span class=\"p\">:</span> <span class=\"n\">main</span><span class=\"p\">}</span>\n        <span class=\"k\">return</span> <span class=\"n\">app</span><span class=\"o\">.</span><span class=\"n\">html_response</span><span class=\"p\">(</span><span class=\"n\">request</span><span class=\"p\">,</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">html_body_template</span><span class=\"p\">,</span>\n                                 <span class=\"n\">context</span><span class=\"o\">=</span><span class=\"n\">context</span><span class=\"p\">)</span>\n</div>\n<div class=\"viewcode-block\" id=\"Router.build_main\"><a class=\"viewcode-back\" href=\"../../../api/angular#lux.extensions.angular.Router.build_main\">[docs]</a>    <span class=\"k\">def</span> <span class=\"nf\">build_main</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span> <span class=\"n\">request</span><span class=\"p\">):</span>\n        <span class=\"sd\">&#39;&#39;&#39;Build the main view for this router</span>\n<span class=\"sd\">        &#39;&#39;&#39;</span>\n        <span class=\"k\">return</span> <span class=\"s\">&#39;&#39;</span>\n</div>\n<div class=\"viewcode-block\" id=\"Router.uiview\"><a class=\"viewcode-back\" href=\"../../../api/angular#lux.extensions.angular.Router.uiview\">[docs]</a>    <span class=\"k\">def</span> <span class=\"nf\">uiview</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span> <span class=\"n\">app</span><span class=\"p\">,</span> <span class=\"n\">main</span><span class=\"p\">,</span> <span class=\"n\">jscontext</span><span class=\"p\">):</span>\n        <span class=\"sd\">&#39;&#39;&#39;Wrap the ``main`` html with a ``ui-view`` container.</span>\n<span class=\"sd\">        Add animation class if specified in :setting:`ANGULAR_VIEW_ANIMATE`.</span>\n<span class=\"sd\">        &#39;&#39;&#39;</span>\n        <span class=\"n\">main</span> <span class=\"o\">=</span> <span class=\"n\">Html</span><span class=\"p\">(</span><span class=\"s\">&#39;div&#39;</span><span class=\"p\">,</span> <span class=\"n\">main</span><span class=\"p\">,</span> <span class=\"n\">cn</span><span class=\"o\">=</span><span class=\"s\">&#39;hidden&#39;</span><span class=\"p\">,</span> <span class=\"nb\">id</span><span class=\"o\">=</span><span class=\"s\">&quot;seo-view&quot;</span><span class=\"p\">)</span>\n        <span class=\"n\">div</span> <span class=\"o\">=</span> <span class=\"n\">Html</span><span class=\"p\">(</span><span class=\"s\">&#39;div&#39;</span><span class=\"p\">,</span> <span class=\"n\">main</span><span class=\"p\">,</span> <span class=\"n\">cn</span><span class=\"o\">=</span><span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">angular_view_class</span><span class=\"p\">)</span>\n        <span class=\"n\">animate</span> <span class=\"o\">=</span> <span class=\"n\">app</span><span class=\"o\">.</span><span class=\"n\">config</span><span class=\"p\">[</span><span class=\"s\">&#39;ANGULAR_VIEW_ANIMATE&#39;</span><span class=\"p\">]</span>\n        <span class=\"k\">if</span> <span class=\"n\">animate</span><span class=\"p\">:</span>\n            <span class=\"n\">jscontext</span><span class=\"p\">[</span><span class=\"s\">&#39;ngModules&#39;</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">add</span><span class=\"p\">(</span><span class=\"s\">&#39;ngAnimate&#39;</span><span class=\"p\">)</span>\n            <span class=\"n\">div</span><span class=\"o\">.</span><span class=\"n\">addClass</span><span class=\"p\">(</span><span class=\"n\">animate</span><span class=\"p\">)</span>\n        <span class=\"n\">div</span><span class=\"o\">.</span><span class=\"n\">data</span><span class=\"p\">(</span><span class=\"s\">&#39;ui-view&#39;</span><span class=\"p\">,</span> <span class=\"s\">&#39;main&#39;</span><span class=\"p\">)</span>\n        <span class=\"k\">return</span> <span class=\"n\">div</span><span class=\"o\">.</span><span class=\"n\">render</span><span class=\"p\">()</span>\n</div>\n<div class=\"viewcode-block\" id=\"Router.state_template\"><a class=\"viewcode-back\" href=\"../../../api/angular#lux.extensions.angular.Router.state_template\">[docs]</a>    <span class=\"k\">def</span> <span class=\"nf\">state_template</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span> <span class=\"n\">app</span><span class=\"p\">):</span>\n        <span class=\"sd\">&#39;&#39;&#39;Template for ui-router state associated with this router.</span>\n<span class=\"sd\">        &#39;&#39;&#39;</span>\n        <span class=\"k\">pass</span>\n</div>\n    <span class=\"k\">def</span> <span class=\"nf\">get_controller</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span> <span class=\"n\">app</span><span class=\"p\">):</span>\n        <span class=\"k\">return</span> <span class=\"s\">&#39;Html5&#39;</span>\n\n<div class=\"viewcode-block\" id=\"Router.angular_page\"><a class=\"viewcode-back\" href=\"../../../api/angular#lux.extensions.angular.Router.angular_page\">[docs]</a>    <span class=\"k\">def</span> <span class=\"nf\">angular_page</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span> <span class=\"n\">app</span><span class=\"p\">,</span> <span class=\"n\">page</span><span class=\"p\">):</span>\n        <span class=\"sd\">&#39;&#39;&#39;Callback for adding additional data to angular page object</span>\n<span class=\"sd\">        &#39;&#39;&#39;</span>\n        <span class=\"k\">pass</span>\n</div>\n<div class=\"viewcode-block\" id=\"Router.sitemap\"><a class=\"viewcode-back\" href=\"../../../api/angular#lux.extensions.angular.Router.sitemap\">[docs]</a>    <span class=\"k\">def</span> <span class=\"nf\">sitemap</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span> <span class=\"n\">app</span><span class=\"p\">,</span> <span class=\"n\">ngmodules</span><span class=\"p\">):</span>\n        <span class=\"sd\">&#39;&#39;&#39;Build the sitemap used by angular `ui-router`_</span>\n<span class=\"sd\">        &#39;&#39;&#39;</span>\n        <span class=\"n\">root</span> <span class=\"o\">=</span> <span class=\"bp\">self</span>\n        <span class=\"k\">while</span> <span class=\"nb\">isinstance</span><span class=\"p\">(</span><span class=\"n\">root</span><span class=\"o\">.</span><span class=\"n\">parent</span><span class=\"p\">,</span> <span class=\"n\">Router</span><span class=\"p\">):</span>\n            <span class=\"n\">root</span> <span class=\"o\">=</span> <span class=\"n\">root</span><span class=\"o\">.</span><span class=\"n\">parent</span>\n        <span class=\"k\">if</span> <span class=\"n\">root</span><span class=\"o\">.</span><span class=\"n\">_sitemap</span> <span class=\"ow\">is</span> <span class=\"bp\">None</span><span class=\"p\">:</span>\n            <span class=\"n\">ngmodules</span><span class=\"o\">.</span><span class=\"n\">add</span><span class=\"p\">(</span><span class=\"s\">&#39;ui.router&#39;</span><span class=\"p\">)</span>\n            <span class=\"n\">sitemap</span> <span class=\"o\">=</span> <span class=\"p\">{</span><span class=\"s\">&#39;hrefs&#39;</span><span class=\"p\">:</span> <span class=\"p\">[],</span>\n                       <span class=\"s\">&#39;pages&#39;</span><span class=\"p\">:</span> <span class=\"p\">{},</span>\n                       <span class=\"s\">&#39;uiRouter&#39;</span><span class=\"p\">:</span> <span class=\"bp\">True</span><span class=\"p\">,</span>\n                       <span class=\"s\">&#39;ngModules&#39;</span><span class=\"p\">:</span> <span class=\"n\">ngmodules</span><span class=\"p\">}</span>\n            <span class=\"n\">add_to_sitemap</span><span class=\"p\">(</span><span class=\"n\">sitemap</span><span class=\"p\">,</span> <span class=\"n\">app</span><span class=\"p\">,</span> <span class=\"n\">root</span><span class=\"p\">)</span>\n            <span class=\"n\">root</span><span class=\"o\">.</span><span class=\"n\">_sitemap</span> <span class=\"o\">=</span> <span class=\"n\">sitemap</span>\n        <span class=\"k\">return</span> <span class=\"n\">root</span><span class=\"o\">.</span><span class=\"n\">_sitemap</span>\n</div>\n    <span class=\"k\">def</span> <span class=\"nf\">childname</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span> <span class=\"n\">prefix</span><span class=\"p\">):</span>\n        <span class=\"k\">return</span> <span class=\"s\">&#39;</span><span class=\"si\">%s%s</span><span class=\"s\">&#39;</span> <span class=\"o\">%</span> <span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">name</span><span class=\"p\">,</span> <span class=\"n\">prefix</span><span class=\"p\">)</span> <span class=\"k\">if</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">name</span> <span class=\"k\">else</span> <span class=\"n\">prefix</span>\n\n<div class=\"viewcode-block\" id=\"Router.instance_url\"><a class=\"viewcode-back\" href=\"../../../api/angular#lux.extensions.angular.Router.instance_url\">[docs]</a>    <span class=\"k\">def</span> <span class=\"nf\">instance_url</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span> <span class=\"n\">request</span><span class=\"p\">,</span> <span class=\"n\">instance</span><span class=\"p\">):</span>\n        <span class=\"sd\">&#39;&#39;&#39;Return the url for editing the ``instance``</span>\n<span class=\"sd\">        &#39;&#39;&#39;</span>\n        <span class=\"k\">pass</span>\n</div>\n    <span class=\"k\">def</span> <span class=\"nf\">make_router</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span> <span class=\"n\">rule</span><span class=\"p\">,</span> <span class=\"n\">method</span><span class=\"o\">=</span><span class=\"bp\">None</span><span class=\"p\">,</span> <span class=\"n\">handler</span><span class=\"o\">=</span><span class=\"bp\">None</span><span class=\"p\">,</span> <span class=\"n\">cls</span><span class=\"o\">=</span><span class=\"bp\">None</span><span class=\"p\">,</span> <span class=\"o\">**</span><span class=\"n\">params</span><span class=\"p\">):</span>\n        <span class=\"n\">cls</span> <span class=\"o\">=</span> <span class=\"n\">cls</span> <span class=\"ow\">or</span> <span class=\"n\">Router</span>\n        <span class=\"k\">if</span> <span class=\"n\">cls</span> <span class=\"ow\">is</span> <span class=\"n\">Router</span> <span class=\"ow\">and</span> <span class=\"n\">method</span> <span class=\"o\">==</span> <span class=\"s\">&#39;get&#39;</span><span class=\"p\">:</span>\n            <span class=\"n\">method</span> <span class=\"o\">=</span> <span class=\"s\">&#39;build_main&#39;</span>\n        <span class=\"k\">return</span> <span class=\"nb\">super</span><span class=\"p\">(</span><span class=\"n\">Router</span><span class=\"p\">,</span> <span class=\"bp\">self</span><span class=\"p\">)</span><span class=\"o\">.</span><span class=\"n\">make_router</span><span class=\"p\">(</span>\n            <span class=\"n\">rule</span><span class=\"p\">,</span> <span class=\"n\">method</span><span class=\"o\">=</span><span class=\"n\">method</span><span class=\"p\">,</span> <span class=\"n\">handler</span><span class=\"o\">=</span><span class=\"n\">handler</span><span class=\"p\">,</span> <span class=\"n\">cls</span><span class=\"o\">=</span><span class=\"n\">cls</span><span class=\"p\">,</span> <span class=\"o\">**</span><span class=\"n\">params</span><span class=\"p\">)</span>\n\n</div>\n<span class=\"k\">def</span> <span class=\"nf\">router_href</span><span class=\"p\">(</span><span class=\"n\">app</span><span class=\"p\">,</span> <span class=\"n\">route</span><span class=\"p\">):</span>\n    <span class=\"n\">url</span> <span class=\"o\">=</span> <span class=\"s\">&#39;/&#39;</span><span class=\"o\">.</span><span class=\"n\">join</span><span class=\"p\">(</span><span class=\"n\">_angular_route</span><span class=\"p\">(</span><span class=\"n\">route</span><span class=\"p\">))</span>\n    <span class=\"k\">if</span> <span class=\"n\">url</span><span class=\"p\">:</span>\n        <span class=\"n\">url</span> <span class=\"o\">=</span> <span class=\"s\">&#39;/</span><span class=\"si\">%s</span><span class=\"s\">&#39;</span> <span class=\"o\">%</span> <span class=\"n\">url</span> <span class=\"k\">if</span> <span class=\"n\">route</span><span class=\"o\">.</span><span class=\"n\">is_leaf</span> <span class=\"k\">else</span> <span class=\"s\">&#39;/</span><span class=\"si\">%s</span><span class=\"s\">/&#39;</span> <span class=\"o\">%</span> <span class=\"n\">url</span>\n    <span class=\"k\">else</span><span class=\"p\">:</span>\n        <span class=\"n\">url</span> <span class=\"o\">=</span> <span class=\"s\">&#39;/&#39;</span>\n    <span class=\"n\">site_url</span> <span class=\"o\">=</span> <span class=\"n\">app</span><span class=\"o\">.</span><span class=\"n\">config</span><span class=\"p\">[</span><span class=\"s\">&#39;SITE_URL&#39;</span><span class=\"p\">]</span>\n    <span class=\"k\">if</span> <span class=\"n\">site_url</span><span class=\"p\">:</span>\n        <span class=\"n\">p</span> <span class=\"o\">=</span> <span class=\"n\">urlparse</span><span class=\"p\">(</span><span class=\"n\">site_url</span> <span class=\"o\">+</span> <span class=\"n\">url</span><span class=\"p\">)</span>\n        <span class=\"k\">return</span> <span class=\"n\">p</span><span class=\"o\">.</span><span class=\"n\">path</span>\n    <span class=\"k\">else</span><span class=\"p\">:</span>\n        <span class=\"k\">return</span> <span class=\"n\">url</span>\n\n\n<span class=\"k\">def</span> <span class=\"nf\">_angular_route</span><span class=\"p\">(</span><span class=\"n\">route</span><span class=\"p\">):</span>\n    <span class=\"k\">for</span> <span class=\"n\">is_dynamic</span><span class=\"p\">,</span> <span class=\"n\">val</span> <span class=\"ow\">in</span> <span class=\"n\">route</span><span class=\"o\">.</span><span class=\"n\">breadcrumbs</span><span class=\"p\">:</span>\n        <span class=\"k\">if</span> <span class=\"n\">is_dynamic</span><span class=\"p\">:</span>\n            <span class=\"n\">c</span> <span class=\"o\">=</span> <span class=\"n\">route</span><span class=\"o\">.</span><span class=\"n\">_converters</span><span class=\"p\">[</span><span class=\"n\">val</span><span class=\"p\">]</span>\n            <span class=\"k\">yield</span> <span class=\"s\">&#39;*</span><span class=\"si\">%s</span><span class=\"s\">&#39;</span> <span class=\"o\">%</span> <span class=\"n\">val</span> <span class=\"k\">if</span> <span class=\"n\">c</span><span class=\"o\">.</span><span class=\"n\">regex</span> <span class=\"o\">==</span> <span class=\"s\">&#39;.*&#39;</span> <span class=\"k\">else</span> <span class=\"s\">&#39;:</span><span class=\"si\">%s</span><span class=\"s\">&#39;</span> <span class=\"o\">%</span> <span class=\"n\">val</span>\n        <span class=\"k\">else</span><span class=\"p\">:</span>\n            <span class=\"k\">yield</span> <span class=\"n\">val</span>\n\n\n<span class=\"k\">def</span> <span class=\"nf\">add_to_sitemap</span><span class=\"p\">(</span><span class=\"n\">sitemap</span><span class=\"p\">,</span> <span class=\"n\">app</span><span class=\"p\">,</span> <span class=\"n\">router</span><span class=\"p\">,</span> <span class=\"n\">parent</span><span class=\"o\">=</span><span class=\"bp\">None</span><span class=\"p\">):</span>\n    <span class=\"c\"># Router variables</span>\n    <span class=\"k\">if</span> <span class=\"ow\">not</span> <span class=\"nb\">isinstance</span><span class=\"p\">(</span><span class=\"n\">router</span><span class=\"p\">,</span> <span class=\"n\">Router</span><span class=\"p\">):</span>\n        <span class=\"k\">return</span>\n    <span class=\"n\">uirouter</span> <span class=\"o\">=</span> <span class=\"n\">app</span><span class=\"o\">.</span><span class=\"n\">config</span><span class=\"p\">[</span><span class=\"s\">&#39;ANGULAR_UI_ROUTER&#39;</span><span class=\"p\">]</span> <span class=\"ow\">and</span> <span class=\"n\">router</span><span class=\"o\">.</span><span class=\"n\">uirouter</span>\n    <span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"ow\">not</span> <span class=\"n\">uirouter</span> <span class=\"ow\">or</span>\n            <span class=\"p\">(</span><span class=\"n\">router</span><span class=\"o\">.</span><span class=\"n\">parent</span> <span class=\"ow\">and</span>\n             <span class=\"n\">router</span><span class=\"o\">.</span><span class=\"n\">parent</span><span class=\"o\">.</span><span class=\"n\">html_body_template</span> <span class=\"o\">!=</span> <span class=\"n\">router</span><span class=\"o\">.</span><span class=\"n\">html_body_template</span><span class=\"p\">)):</span>\n        <span class=\"k\">return</span>\n\n    <span class=\"c\"># path for the current router</span>\n    <span class=\"n\">path</span> <span class=\"o\">=</span> <span class=\"n\">router_href</span><span class=\"p\">(</span><span class=\"n\">app</span><span class=\"p\">,</span> <span class=\"n\">router</span><span class=\"o\">.</span><span class=\"n\">full_route</span><span class=\"p\">)</span>\n    <span class=\"c\">#</span>\n    <span class=\"n\">page</span> <span class=\"o\">=</span> <span class=\"p\">{</span><span class=\"s\">&#39;url&#39;</span><span class=\"p\">:</span> <span class=\"n\">path</span><span class=\"p\">,</span>\n            <span class=\"s\">&#39;name&#39;</span><span class=\"p\">:</span> <span class=\"n\">router</span><span class=\"o\">.</span><span class=\"n\">name</span><span class=\"p\">,</span>\n            <span class=\"s\">&#39;template&#39;</span><span class=\"p\">:</span> <span class=\"n\">router</span><span class=\"o\">.</span><span class=\"n\">state_template</span><span class=\"p\">(</span><span class=\"n\">app</span><span class=\"p\">),</span>\n            <span class=\"s\">&#39;api&#39;</span><span class=\"p\">:</span> <span class=\"n\">router</span><span class=\"o\">.</span><span class=\"n\">get_api_info</span><span class=\"p\">(</span><span class=\"n\">app</span><span class=\"p\">),</span>\n            <span class=\"s\">&#39;controller&#39;</span><span class=\"p\">:</span> <span class=\"n\">router</span><span class=\"o\">.</span><span class=\"n\">get_controller</span><span class=\"p\">(</span><span class=\"n\">app</span><span class=\"p\">),</span>\n            <span class=\"s\">&#39;parent&#39;</span><span class=\"p\">:</span> <span class=\"n\">parent</span><span class=\"p\">}</span>\n    <span class=\"n\">router</span><span class=\"o\">.</span><span class=\"n\">angular_page</span><span class=\"p\">(</span><span class=\"n\">app</span><span class=\"p\">,</span> <span class=\"n\">page</span><span class=\"p\">)</span>\n    <span class=\"n\">sitemap</span><span class=\"p\">[</span><span class=\"s\">&#39;hrefs&#39;</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">append</span><span class=\"p\">(</span><span class=\"n\">path</span><span class=\"p\">)</span>\n    <span class=\"n\">sitemap</span><span class=\"p\">[</span><span class=\"s\">&#39;pages&#39;</span><span class=\"p\">][</span><span class=\"n\">path</span><span class=\"p\">]</span> <span class=\"o\">=</span> <span class=\"n\">page</span>\n    <span class=\"k\">if</span> <span class=\"n\">router</span><span class=\"o\">.</span><span class=\"n\">ngmodules</span><span class=\"p\">:</span>\n        <span class=\"n\">sitemap</span><span class=\"p\">[</span><span class=\"s\">&#39;ngModules&#39;</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">update</span><span class=\"p\">(</span><span class=\"n\">router</span><span class=\"o\">.</span><span class=\"n\">ngmodules</span><span class=\"p\">)</span>\n    <span class=\"c\">#</span>\n    <span class=\"c\"># Loop over children routes</span>\n    <span class=\"k\">for</span> <span class=\"n\">child</span> <span class=\"ow\">in</span> <span class=\"n\">router</span><span class=\"o\">.</span><span class=\"n\">routes</span><span class=\"p\">:</span>\n        <span class=\"c\">#</span>\n        <span class=\"c\"># This is the first child</span>\n        <span class=\"k\">if</span> <span class=\"ow\">not</span> <span class=\"n\">parent</span><span class=\"p\">:</span>\n            <span class=\"n\">getmany</span> <span class=\"o\">=</span> <span class=\"bp\">True</span>\n            <span class=\"n\">apiname</span> <span class=\"o\">=</span> <span class=\"n\">router</span><span class=\"o\">.</span><span class=\"n\">name</span>\n        <span class=\"n\">add_to_sitemap</span><span class=\"p\">(</span><span class=\"n\">sitemap</span><span class=\"p\">,</span> <span class=\"n\">app</span><span class=\"p\">,</span> <span class=\"n\">child</span><span class=\"p\">,</span> <span class=\"n\">path</span><span class=\"p\">)</span>\n\n    <span class=\"c\"># Add redirect to folder page if required</span>\n    <span class=\"k\">if</span> <span class=\"n\">path</span><span class=\"o\">.</span><span class=\"n\">endswith</span><span class=\"p\">(</span><span class=\"s\">&#39;/&#39;</span><span class=\"p\">)</span> <span class=\"ow\">and</span> <span class=\"n\">path</span> <span class=\"o\">!=</span> <span class=\"s\">&#39;/&#39;</span><span class=\"p\">:</span>\n        <span class=\"n\">rpath</span> <span class=\"o\">=</span> <span class=\"n\">path</span><span class=\"p\">[:</span><span class=\"o\">-</span><span class=\"mi\">1</span><span class=\"p\">]</span>\n        <span class=\"k\">if</span> <span class=\"n\">rpath</span> <span class=\"ow\">not</span> <span class=\"ow\">in</span> <span class=\"n\">sitemap</span><span class=\"p\">[</span><span class=\"s\">&#39;pages&#39;</span><span class=\"p\">]:</span>\n            <span class=\"n\">page</span> <span class=\"o\">=</span> <span class=\"p\">{</span><span class=\"s\">&#39;url&#39;</span><span class=\"p\">:</span> <span class=\"n\">rpath</span><span class=\"p\">,</span>\n                    <span class=\"s\">&#39;redirectTo&#39;</span><span class=\"p\">:</span> <span class=\"n\">path</span><span class=\"p\">}</span>\n            <span class=\"n\">sitemap</span><span class=\"p\">[</span><span class=\"s\">&#39;hrefs&#39;</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">append</span><span class=\"p\">(</span><span class=\"n\">rpath</span><span class=\"p\">)</span>\n            <span class=\"n\">sitemap</span><span class=\"p\">[</span><span class=\"s\">&#39;pages&#39;</span><span class=\"p\">][</span><span class=\"n\">rpath</span><span class=\"p\">]</span> <span class=\"o\">=</span> <span class=\"n\">page</span>\n</pre></div>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>\n<div class='small hidden-print text-muted' id='page-footer'>\n    <div class='container'>\n        <div class='row'>\n            <div class='block col-sm-5'>\n                <div class='hidden-xs'>\n                    <ul class=\"fa-ul text-left\">\n    <li><i class=\"fa-li fa fa-copyright\"></i>2014 <a href=\"http://quantmind.com\">Quantmind</a></li>\n    <li>Site build with Lux on python 3.4.2</li>\n    <li>Docs build with <a href=\"http://sphinx-doc.org/\" target=\"_blank\">Sphinx</a></li>\n    <li><a href=\"http://quantmind.github.io/lux/docs/changelog\">Changelog</a></li>\n    <li><a href=\"http://quantmind.github.io/lux/docs/api/\">API</a></li>\n    <li><a href=\"http://quantmind.github.io/lux/docs/EXTENSIONS/\">Extensions</a></li>\n    <li><a href=\"http://quantmind.github.io/lux/images\">Images</a></li>\n</ul>\n                </div>\n                <div class='text-center visible-xs'>\n                    <ul class=\"fa-ul text-left\">\n    <li><i class=\"fa-li fa fa-copyright\"></i>2014 <a href=\"http://quantmind.com\">Quantmind</a></li>\n    <li>Site build with Lux on python 3.4.2</li>\n    <li>Docs build with <a href=\"http://sphinx-doc.org/\" target=\"_blank\">Sphinx</a></li>\n    <li><a href=\"http://quantmind.github.io/lux/docs/changelog\">Changelog</a></li>\n    <li><a href=\"http://quantmind.github.io/lux/docs/api/\">API</a></li>\n    <li><a href=\"http://quantmind.github.io/lux/docs/EXTENSIONS/\">Extensions</a></li>\n    <li><a href=\"http://quantmind.github.io/lux/images\">Images</a></li>\n</ul>\n                </div>\n            </div>\n            <div class='block col-sm-2 text-center'>\n                <div class='hidden-xs'>\n                    <p><a href='#top' title=\"Lux\" class=\"hover-opacity\">\n    <img height=50 title='Lux' src='http://quantmind.github.io/lux/media/luxsite/lux.png' alt='Lux'>\n</a></p>\n                </div>\n                <div class='visible-xs'>\n                    <p><a href='https://twitter.com/quantmind' title='Follow quantmind on twitter'>\n<i class='fa fa-twitter fa-2x'></i></a>\n<a href='https://plus.google.com/+QuantmindPlus' title='Follow quantmind on google+'>\n<i class='fa fa-google-plus-square fa-2x'></i></a>\n<a href='https://www.facebook.com/quantmind' title='Follow quantmind on facebook'>\n<i class='fa fa-facebook-square fa-2x'></i></a>\n<a href='https://github.com/quantmind/lux' title='Lux on github'>\n<i class='fa fa-github fa-2x'></i></a></p>\n                </div>\n            </div>\n            <div class='block col-sm-5'>\n                <div class='text-right hidden-xs'>\n                    <p><a href='https://twitter.com/quantmind' title='Follow quantmind on twitter'>\n<i class='fa fa-twitter fa-2x'></i></a>\n<a href='https://plus.google.com/+QuantmindPlus' title='Follow quantmind on google+'>\n<i class='fa fa-google-plus-square fa-2x'></i></a>\n<a href='https://www.facebook.com/quantmind' title='Follow quantmind on facebook'>\n<i class='fa fa-facebook-square fa-2x'></i></a>\n<a href='https://github.com/quantmind/lux' title='Lux on github'>\n<i class='fa fa-github fa-2x'></i></a></p>\n                </div>\n                <div class='text-center visible-xs'>\n                    <p><a href='#top' title=\"Lux\" class=\"hover-opacity\">\n    <img height=50 title='Lux' src='http://quantmind.github.io/lux/media/luxsite/lux.png' alt='Lux'>\n</a></p>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>"}}